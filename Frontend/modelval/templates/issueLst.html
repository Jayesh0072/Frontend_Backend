{% extends 'base.html' %} 
{% load static %}  
{% block content %} 
    
<!-- <div class="col-12">
    <div class="mx-n4 px-4 mx-lg-n6 bg-white pt-6 bord
    er-top border-300" style="padding-top: 0.5rem !important;padding-bottom: 0.5rem !important;">
      <div class="card shadow-none border border-300 my-4" style="margin-top: 0.0rem !important;" data-component-card="data-component-card">
        <div class="card-header p-4 border-bottom border-300 bg-soft" style="padding-top: 5px !important;padding-bottom: 5px !important;">
          <div class="row g-3 justify-content-between align-items-center">
            <div class="col-2 col-md">
              <h4 data-anchor="data-anchor"> Issues <span style="font-size: medium;">(Brief summary of all Issues)</span></h4>
             </div>
             
            <div class="col col-md-auto">
              <nav class="nav nav-underline justify-content-end doc-tab-nav align-items-center" role="tablist">
               
                <a class="btn btn-sm btn-phoenix-primary code-btn ms-2"  style="width: 5px;border: none;" data-bs-toggle="collapse" href="#pnl-issueSummary" role="button" 
                aria-controls="pnl-issueSummary" aria-expanded="false"> <span class="me-2" data-feather="plus-square"></span> </a>
                <a class="btn btn-sm btn-phoenix-primary preview-btn ms-2" style="width: 5px;border: none;"><span class="me-2" data-feather="minus-square"></span></a>
              </nav>
            </div>
          </div>
        </div>
        <div class="card-body" style="padding-bottom: 0px;">
            <div class="collapse code-collapse collapse show" id="pnl-issueSummary">
              <div id="projectSummary" data-list='{"valueNames":["U_Role","Issue_ID","Department","Originator","Task_Function_Label","Registration_Date","Task_Type_label","Sub_Task_Type","Task_Priority_Label","end_dt","Completion_Status","Task_ApprovalStatus_Label"],"page":5,"pagination":true}'>
                <div class="table-responsive scrollbar" >
                  <table class="table fs--1 mb-0 border-top border-200">
                    <thead>
                      <tr>
                        <th class="white-space-nowrap align-middle ps-0" scope="col" data-sort="Issue_ID" style="width:8%;"></th>
                        <th class="sort white-space-nowrap align-middle ps-0" scope="col" data-sort="Issue_ID" style="width:8%;">Issue ID</th>
                        <th class="sort white-space-nowrap align-middle ps-0" scope="col" data-sort="U_Role" style="width:8%;">Role</th>                            
                        <th class="sort align-middle ps-3" scope="col" data-sort="Task_Priority_Label" style="width:30%;">Priority</th>
                        <th class="sort align-middle ps-3" scope="col" data-sort="Task_ApprovalStatus_Label" style="width:10%;">Approval Status</th>
                        <th class="sort align-middle ps-3" scope="col" data-sort="Task_Function_Label" style="width:15%;">Task Function</th>
                        <th class="sort align-middle ps-3" scope="col" data-sort="Task_Type_label" style="width:12%;">Task Type</th>
                        <th class="sort align-middle ps-3" scope="col" data-sort="Completion_Status" style="width:9%;">Completion Status</th>
                        <th class="sort align-middle text-end" scope="col" data-sort="end_dt" style="width:10%;">End Date</th>
                      </tr>
                    </thead>  
                    <tbody class="list" id="project-list-table-body">
                      {% for key, val in issueList.items  %}             
                        <tr class="position-static">
                          <td class="align-middle time white-space-nowrap ps-0 Issue_ID py-4">
                            <span class="nav-link-icon" style="padding-right: 5px;" data-toggle="tooltip" title="Upcoming"><span  class="{{val.Upcoming}}" data-feather="calendar"></span></span>
                            <span class="nav-link-icon" style="padding-right: 5px;" data-toggle="tooltip" title="Task"><span  class="{{val.Task}}"  data-feather="flag"></span></span>
                            <span class="nav-link-icon"  data-toggle="tooltip" title="Activity"><span  class="{{val.Activity}}"  data-feather="activity"></span></span>
                          </td>
                          <td class="align-middle time white-space-nowrap ps-0 Issue_ID py-4">
                            
                            <a class="text-decoration-none fw-bold fs-0" href="#!" onclick="redirectIssues('{{val.Issue_ID}}','{{val.U_Role}}')" >{{val.Issue_ID}}</a>
                          </td>
                          <td class="align-middle time white-space-nowrap ps-0 U_Role py-4">
                            
                            {{val.U_Role}}</a>
                          </td>
                          <td class="align-middle white-space-nowrap Process_Name ps-3 py-4">
                            
                            {%if val.Issue_Priority_Label == "High" %}
                              <h5><span class="badge badge-phoenix badge-phoenix-danger">High</span></h5>
                            {%elif val.Issue_Priority_Label == "Medium" %}
                                <h5><span class="badge badge-phoenix badge-phoenix-warning">Medium</span></h5>
                            {%elif val.Issue_Priority_Label == "Low" %}
                                <h5><span class="badge badge-phoenix badge-phoenix-success">Low</span></h5>
                            {% endif %}
                          </td>
                          <td class="align-middle white-space-nowrap Type ps-3 py-4">
                            {{val.Issue_ApprovalStatus_Label}} 
                          </td>
                          <td class="align-middle white-space-nowrap Area ps-3 py-4">
                            {{val.Issue_Function_Label}}
                          </td>
                          <td class="align-middle white-space-nowrap Internal_Vendor ps-3 py-4">
                           {{val.Issue_Type_label}}
                          </td>
                          <td class="align-middle white-space-nowrap ps-3 Status"> 
                          {{val.Completion_Status}}
                          </td>
                          <td class="align-middle white-space-nowrap text-end Approval_Status">                                
                           {{val.end_dt}}
                          </td> 
                        </tr>
                      {% endfor %}   
                    </tbody>
                  </table>
                </div>
                <div class="d-flex flex-wrap align-items-center justify-content-between py-3 pe-0 fs--1 border-bottom border-200">
                  <div class="d-flex">
                    <p class="mb-0 d-none d-sm-block me-3 fw-semi-bold text-900" data-list-info="data-list-info"></p><a class="fw-semi-bold" href="#!" data-list-view="*">View all<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a><a class="fw-semi-bold d-none" href="#!" data-list-view="less">View Less<span class="fas fa-angle-right ms-1" data-fa-transform="down-1"></span></a>
                  </div>
                  <div class="d-flex">
                    <button class="page-link" data-list-pagination="prev"><span class="fas fa-chevron-left"></span></button>
                    <ul class="mb-0 pagination"></ul>
                    <button class="page-link pe-0" data-list-pagination="next"><span class="fas fa-chevron-right"></span></button>
                  </div>
                </div>
              </div>
              </div>
        </div>  
          </div>  
    </div>
  </div> -->

  <div class="content" style="padding-top:0px;"> 
    <div class="content container-fluid">
      <!-- Page Header -->
    
      <!-- End Page Header -->
  
  
      <!-- Card -->
      <div class="card mb-3 mb-lg-5">
        <!-- Header -->
        <div class="card-header">
          <div class="row justify-content-between align-items-center flex-grow-1">
            <div class="col-md">
              <div class="d-flex justify-content-between align-items-center">
                <h4 class="card-header-title">Issues(Brief summary of all Issues)</h4>
  
                
              </div>
            </div>
             
          </div>
          <!-- End Row -->
        </div>
        <!-- End Header --> 
        <div id="div_issuesummary" > 
                          
          <div class="card-header">
            <div class="row justify-content-between align-items-center flex-grow-1">
              <div class="col-md">
                <div class="d-flex justify-content-between align-items-center"> 
                  <!-- Datatable Info -->
                  <div id="datatableCounterInfo" style="display: none;">
                    <div class="d-flex align-items-center">
                      <span class="fs-6 me-3">
                        <span id="datatableCounter">0</span>
                        Selected
                      </span>
                      <a class="btn btn-outline-danger btn-sm" href="javascript:;">
                        <i class="tio-delete-outlined"></i> Delete
                      </a>
                    </div>
                  </div>
                  <!-- End Datatable Info -->
                </div>
              </div>
              <!-- End Col -->
              <div class="col-auto">
                <!-- Filter -->
                <div class="row align-items-sm-center">
                  <div class="col-sm-auto">
                    <div class="row align-items-center gx-0">
                      <div class="col">
                        <span class="text-secondary me-2">Approval Status:</span>
                      </div>
                      <!-- End Col -->

                      <div class="col-auto">
                        <!-- Select -->
                        <div class="tom-select-custom tom-select-custom-end">
                          <select class="js-select js-datatable-filter form-select form-select-sm form-select-borderless" data-target-column-index="4" data-target-table="datatable_Issue" autocomplete="off" data-hs-tom-select-options='{
                                    "searchInDropdown": false,
                                    "hideSearch": true,
                                    "dropdownWidth": "10rem"
                                  }'>
                            <option value="null" selected>All</option>
                            <option value="Pending">Pending</option>
                            <option value="Approved">Approved</option>
                            <option value="Provisional Approval">Provisional Approval</option>
                            <option value="Not Approved">Not Approved</option>
                          </select>
                        </div>
                        <!-- End Select -->
                      </div>
                      <!-- End Col -->
                    </div>
                    <!-- End Row -->
                  </div>
                  <!-- End Col -->

                  <div class="col-sm-auto">
                    <div class="row align-items-center gx-0">
                      <div class="col">
                        <span class="text-secondary me-2">Priority :</span>
                      </div>
                      <!-- End Col -->

                      <div class="col-auto">
                        <!-- Select -->
                        <div class="tom-select-custom tom-select-custom-end">
                          <select class="js-select js-datatable-filter form-select form-select-sm form-select-borderless" data-target-column-index="3" data-target-table="datatable_Issue" autocomplete="off" data-hs-tom-select-options='{
                                    "searchInDropdown": false,
                                    "hideSearch": true,
                                    "dropdownWidth": "10rem"
                                  }'>
                            <option value="null" selected>All</option>
                            <option value="Low">Low</option>
                            <option value="Medium">Medium</option>
                            <option value="High">High</option>
                          </select>
                        </div>
                        <!-- End Select -->
                      </div>
                      <!-- End Col -->
                    </div>
                    <!-- End Row -->
                  </div>
                  <!-- End Col -->

                  <div class="col-md">
                    <form>
                      <!-- Search -->
                      <div class="input-group input-group-merge input-group-flush">
                        <div class="input-group-prepend input-group-text">
                          <i class="bi-search"></i>
                        </div>
                        <input id="datatableSearch_Issue" type="search" class="form-control" placeholder="Search" aria-label="Search">
                      </div>
                      <!-- End Search -->
                    </form>
                  </div> 
                </div>
                <!-- End Filter -->
              </div>
              <!-- End Col -->
            </div>
            <!-- End Row -->
          </div>
          <!-- End Header -->

          <!-- Table -->
          <div class="table-responsive datatable-custom">
            <table id="datatable_Issue" class="table table-borderless table-thead-bordered table-nowrap table-align-middle card-table" data-hs-datatables-options='{
                    "columnDefs": [{
                        "targets": [0],
                        "orderable": false
                      }],
                    "order": [],
                    "info": {
                      "totalQty": "#datatableWithPaginationInfoTotalQty_Issue"
                    },
                    "search": "#datatableSearch_Issue",
                    "entries": "#datatableEntries_Issue",
                    "pageLength": 5,
                    "isResponsive": false,
                    "isShowPaging": false,
                    "pagination": "datatablePagination_Issue"
                  }'>
                  <thead class="thead-light">
                    <tr>
                      <th></th>
                      <th>Issue ID</th>
                      <th>End Date</th>                
                      <th>Priority</th>
                      <th>Approval Status</th>
                      <th>Originator</th>
                      <th>Assignee</th>
                      <th>Approver</th>
                      <th>Issue Function</th>
                      <th>Issue Type</th>
                      <th>Completion Status</th>
                      
                    
                     
                    </tr>
                  </thead>
        
                  <tbody>
                    {% for key, val in issueList.items  %}             
                        <tr class="position-static">
                          <td >
                            <span class="nav-link-icon" style="padding-right: 5px;" data-toggle="tooltip" title="Upcoming"><span  class="{{val.Upcoming}}" data-feather="calendar"></span></span>
                            <span class="nav-link-icon" style="padding-right: 5px;" data-toggle="tooltip" title="Task"><span  class="{{val.Task}}"  data-feather="flag"></span></span>
                            <span class="nav-link-icon"  data-toggle="tooltip" title="Activity"><span  class="{{val.Activity}}"  data-feather="activity"></span></span>
                          </td>
                          <td>
                            
                            <a class="text-decoration-none fw-bold fs-0" href="#!" onclick="redirectIssues('{{val.Issue_ID}}','{{val.U_Role}}')" >{{val.Issue_ID}}</a>
                          </td>
                          <td>                                
                            {{val.end_dt}}
                          </td> 
                          <td> 
                            {%if val.Issue_Priority_Label == "High" %}
                              <h5><span class="badge bg-soft-danger text-danger"  style="font-size: inherit;">High</span></h5>
                            {%elif val.Issue_Priority_Label == "Medium" %}
                                <h5><span class="badge bg-soft-warning  text-warning"  style="font-size: inherit;">Medium</span></h5>
                            {%elif val.Issue_Priority_Label == "Low" %}
                                <h5><span class="badge bg-soft-success  text-success" style="font-size: inherit;">Low</span></h5>
                            {% endif %}
                          </td>
                          <td style="text-wrap: wrap;">
                            {{val.Issue_ApprovalStatus_Label}} 
                          </td>
                          <td style="text-wrap: wrap;">                      
                            {{val.originators}}</a>
                          </td>
                          <td style="text-wrap: wrap;">                      
                            {{val.Assignees}}</a>
                          </td>
                          <td style="text-wrap: wrap;">                      
                            {{val.Approvers}}</a>
                          </td>
                          <td>
                            {{val.Issue_Function_Label}}
                          </td>
                          <td>
                          {{val.Issue_Type_label}}
                          </td>
                          <td> 
                          {{val.Completion_Status}}
                          </td>
                          
                        </tr>
                    {% endfor %}   
                  </tbody>
                </table>
          </div>
          <!-- End Table -->

          <!-- Footer -->
          <div class="card-footer">
            <!-- Pagination -->
            <div class="row justify-content-center justify-content-sm-between align-items-sm-center">
              <div class="col-sm mb-2 mb-sm-0">
                <div class="d-flex justify-content-center justify-content-sm-start align-items-center">
                  <span class="me-2">Showing:</span>

                  <!-- Select -->
                  <div class="tom-select-custom">
                    <select id="datatableEntries_Issue" class="js-select form-select form-select-borderless w-auto" autocomplete="off" data-hs-tom-select-options='{
                              "searchInDropdown": false,
                              "hideSearch": true
                            }'>
                      <option value="5" selected>5</option>
                      <option value="10">10</option>
                      <option value="25">25</option>
                      <option value="50" >50</option>
                      <option value="100">100</option>
                    </select>
                  </div>
                  <!-- End Select -->

                  <span class="text-secondary me-2">of</span>

                  <!-- Pagination Quantity -->
                  <span id="datatableWithPaginationInfoTotalQty_Issue"></span>
                </div>
              </div>
              <!-- End Col -->

              <div class="col-sm-auto">
                <div class="d-flex justify-content-center justify-content-sm-end">
                  <!-- Pagination -->
                  <nav id="datatablePagination_Issue" aria-label="Activity pagination"></nav>
                </div>
              </div>
              <!-- End Col -->
            </div>
            <!-- End Pagination -->
          </div>
          <!-- End Footer -->
      </div> 
      </div>
     
      
    </div>
  </div>
  

  {%endblock content %}
  {% block script %} 
  <script src="{% static 'Front/dist/assets/vendor/bootstrap/dist/js/bootstrap.bundle.min.js' %}"></script>
  <script src="{% static 'Front/dist/assets/vendor/jquery/dist/jquery.min.js' %}"></script> 
  <script src="{% static 'Front/dist/assets/vendor/chart.js/dist/Chart.min.js' %}"></script>
  <script src="{% static 'Front/dist/assets/vendor/jquery-migrate/dist/jquery-migrate.min.js' %}"></script>  
   
  <script src="{% static 'Front/dist/assets/vendor/chart.js/dist/Chart.min.js' %}"></script> 
  <script src="{% static 'Front/dist/assets/vendor/chartjs-chart-matrix/dist/chartjs-chart-matrix.min.js' %}"></script>
  <script src="{% static 'Front/dist/assets/vendor/chartjs-adapter-date-fns/dist/chartjs-adapter-date-fns.bundle.min.js' %}"></script>
  <script src="{% static 'Front/dist/assets/vendor/datatables/media/js/jquery.dataTables.min.js' %}"></script> 
  
 
  
  <script src="{% static 'Front/dist/assets/vendor/datatables.net.extensions/select/select.min.js' %}"></script> 
<script src="{% static 'Front/dist/assets/vendor/datatables.net-buttons/js/dataTables.buttons.min.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/datatables.net-buttons/js/buttons.flash.min.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/jszip/dist/jszip.min.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/pdfmake/build/pdfmake.min.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/pdfmake/build/vfs_fonts.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/datatables.net-buttons/js/buttons.html5.min.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/datatables.net-buttons/js/buttons.print.min.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/datatables.net-buttons/js/buttons.colVis.min.js' %}"></script>
<script src="{% static 'Front/dist/assets/vendor/chartjs-plugin-datalabels/dist/chartjs-plugin-datalabels.min.js' %}"></script> 
 <script src="{% static 'Front/dist/assets/js/theme.min.js' %}"></script> 
 <script src="{% static 'Front/dist/assets/vendor/hs-table-sticky-header/src/hs.table-sticky-header.js' %}"></script>
<script type='text/javascript' >
HSCore.components.HSDatatables.init($('#datatable_Issue'), {
      select: {
        style: 'multi',
        selector: 'td:first-child input[type="checkbox"]',
        classMap: {
          checkAll: '#datatableCheckAll',
          counter: '#datatableCounter',
          counterInfo: '#datatableCounterInfo'
        }
      },
      language: {
        zeroRecords: `<div class="text-center p-4">
              <img class="mb-3" src="{% static 'Front/dist/assets/svg/illustrations/oc-error.svg' %}" alt="Image Description" style="width: 10rem;" data-hs-theme-appearance="default">
              <img class="mb-3" src="{% static 'Front/dist/assets/svg/illustrations-light/oc-error.svg' %}" alt="Image Description" style="width: 10rem;" data-hs-theme-appearance="dark">
            <p class="mb-0">No data to show</p>
            </div>`
      }
    });
  function redirectIssues(id,role){ 
        console.log(id,',',role,(role=='Assigned'))
        if(role=='Assigned'){ 
          console.log('inside if')
          document.location.href = "/issue_assignee?id=" +id;
          
        }
  }
</script>
{%endblock script %}